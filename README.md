# Сервис бронирования конференц-залов

Этот проект реализует систему бронирования конференц-залов с использованием REST API. Он позволяет пользователям создавать и просматривать бронирования конференц-залов, при этом гарантируя, что не произойдет пересечения бронирований для одного и того же зала.

## Возможности

- **Создание бронирований**: Забронируйте конференц-зал на конкретный временной интервал.
- **Просмотр бронирований**: Получите все бронирования для конкретного зала.
- **Предотвращение конфликтов**: Система гарантирует, что два бронирования для одного и того же зала не пересекаются по времени.
- **Docker**: Приложение и база данных PostgreSQL работают в контейнерах Docker.

## Требования

Для запуска этого проекта убедитесь, что у вас установлены следующие инструменты:

- [Docker](https://www.docker.com/)
- [Docker Compose](https://docs.docker.com/compose/)
- [Go](https://golang.org/) (для разработки и локального запуска тестов)

## Начало работы

### Запуск приложения

1. **Клонируйте репозиторий**:

   ```bash
   git clone https://github.com/alibekki/conference-room-booking.git
   cd conference-room-booking
    ```

2. **Соберите и запустите приложение с использованием Docker Compose:**
    ```bash
   docker-compose up --build
   ```
   Это запустит следующие сервисы:

- app: Основное Go-приложение, работающее на ```localhost:8080```.
- db: База данных PostgreSQL, работающая на ```localhost:5432```.
- Приложение будет доступно по адресу ```http://localhost:8080```.

## API Endpoints

1. **Создание бронирования**
 -  Endpoint: POST ```/reservations```
  - Описание: Создает новое бронирование для конференц-зала.
  - Request Body:
    ```json
    {
    "room_id": "room_1",
    "start_time": "2024-09-04T09:00:00Z",
    "end_time": "2024-09-04T10:00:00Z"
    }
    ```
 - Responses:
   - ```201 Created```: Бронирование было успешно создано.
   - ```409 Conflict```: Время бронирования пересекается с существующим бронированием
   - ```400 Bad Request```: Неверные данные запроса.

2. **Получение всех бронирований для зала**
  - Endpoint: ```GET /reservations/{room_id}```
  - Описание: Получить все бронирования для конкретного конференц-зала.
  - Response Example:
    ```json
    [
    {
    "id": 1,
    "room_id": "room_1",
    "start_time": "2024-09-04T09:00:00Z",
    "end_time": "2024-09-04T10:00:00Z"
    }
    ]
    ```
### Запуск тестов
В проекте написаны тесты для логики бронирования, которые проверяют:

1. Успешное создание бронирований: Тесты проверяют, что бронирования могут быть созданы без конфликтов.
2. Обработка конфликтующих бронирований: Тесты гарантируют, что пересекающиеся бронирования для одного и того же зала корректно идентифицируются и отклоняются.
3. Конкурентные запросы на бронирование: Тесты симулируют конкурентные (одновременные) запросы на бронирование одного и того же зала и проверяют, что инвариант отсутствия пересекающихся бронирований соблюдается.

**Запуск тестов с помощью Docker**

 Для запуска тестов используется Docker для поднятия экземпляра базы данных PostgreSQL. Все тесты автоматизированы и могут быть запущены одной командой.

1. Убедитесь, что Docker запущен на вашем компьютере.
2. Запустите тесты с помощью следующей команды:
    ```bash
   make test
    ```
Эта команда:

- Запустит контейнер с базой данных PostgreSQL с использованием Docker.
- Запустит тесты логики бронирования, включая обработку успешных бронирований, конфликтов и конкурентных запросов.
- Автоматически остановит контейнер с базой данных после завершения тестов.
